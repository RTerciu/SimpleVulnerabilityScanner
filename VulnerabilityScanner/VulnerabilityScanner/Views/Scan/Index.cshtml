@model VulnerabilityScanner.Models.ScanViewModel
@using VulnerabilityScanner.Models
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Scanare vulnerabilitati</h2>
<hr />
<p>*Exemplu de Cookie care permite autentificarea: PHPSESSID=11755639cec995577eba6cbd1a40fb02;security=low</p>
<div class="col-md-12" style="height:auto;overflow:auto">

    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()
        <input type="text" name="Url" class="form-control" style="max-width:none" placeholder="Introduceti URL-ul pe care doriti sa il scanati" value="@(Model!=null?Model.scannedUrl:"")"/><br />
        <textarea class="form-control" style="max-width:none;" name="Cookie"  placeholder="Introduceti orice cookie care poate ajuta la scanare (ex: cookie de autentificare)...">@(Model != null ? Model.cookie : "")</textarea><br />
        <input type="submit" class="btn btn-danger pull-right" value="Start Scan!" />
    }
</div>
<hr />
@if (Model != null)
{
    if (Model.Message != null)
    {

        <p class="alert-danger"> @Model.Message</p>
    }
<h2>Rezultate Scanare</h2>
<br />
    if (Model.rezultateScanare==null||Model.rezultateScanare.Count == 0)
    {
        <hr />
        <div>

            <p class="alert-success"> Nu au fost gasite vulnerabilitati</p>

        </div>
    }
    else
    {

        <div class="row" style="font-weight:bold;">
            <div class="col-md-4">Tip Vulnerabilitate</div>
            <div class="col-md-4">Pagina             </div>
            <div class="col-md-4">Parametru          </div>
        </div>
        <hr/>
        foreach (ScanResult rezultat in Model.rezultateScanare)
        {

             <div class="row" style="border-bottom:1px solid #808080">
                <div class="col-md-4">@rezultat.VulnerabilityType</div>
                <div class="col-md-4">@rezultat.Page             </div>
                <div class="col-md-4">@rezultat.Parameter        </div>
             </div>


        }

    }


    <br />
    <h2>Toate punctele posibile de injectie</h2>
        <div class="row" style="font-weight:bold;">
            <div class="col-md-3">Nume Parametru</div>
            <div class="col-md-3">Valoare Parametru asa cum a fost intalnit</div>
            <div class="col-md-3">URL actiune</div>
            <div class="col-md-3">Metoda Actiunii</div>
        </div>

    foreach (InjectionPoint punct in Model.injectionPoints)
    {

        <div class="row" style="border-bottom:1px solid #808080">

            <div class="col-md-3">@punct.ParameterName</div>
            <div class="col-md-3">@punct.ParameterValueAsEncountered</div>
            <div class="col-md-3">@punct.UrlAction</div>
            <div class="col-md-3">@punct.formMethod</div>

        </div>

    }
}